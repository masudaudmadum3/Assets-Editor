name: Build Assets Editor (Fixed Path)

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths:
      - "**"
      - ".github/workflows/build-assets-editor.yml"

jobs:
  build:
    name: Build Windows Release
    runs-on: windows-latest

    steps:
      - name: Checkout do Repositório
        uses: actions/checkout@v4

      # Configura .NET 8, 9 e 10 (Removi o 'include-prerelease' que dava aviso)
      - name: Setup .NET SDK
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: |
            8.x
            9.x
            10.x

      # AQUI ESTAVA O ERRO:
      # O comando agora aponta explicitamente para "Assets Editor/Assets Editor.sln"
      # As aspas são importantes porque a pasta tem um espaço no nome.
      - name: Publish Application
        run: |
          dotnet publish "Assets Editor/Assets Editor.sln" -c Release -r win-x64 --self-contained false -o out

      # Copia arquivos extras (se existirem)
      - name: Copy Extra Assets
        shell: pwsh
        run: |
          # Verifica se existe o XML na pasta do projeto e copia para a saída
          if (Test-Path "Assets Editor/Appearances.xml") {
              Copy-Item "Assets Editor/Appearances.xml" -Destination "out/" -Force
              Write-Host "Appearances.xml copiado."
          }
          
          # Lista para conferência
          Get-ChildItem -Path "out"

      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: assets-editor-modern
          path: out/*
